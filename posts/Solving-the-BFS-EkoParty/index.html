<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Solving the BFS Ekoparty 2019 Exploitation Challenge" /><meta property="og:locale" content="en" /><meta name="description" content="This is a quick write up about how one of our team members, Thanasis, solved the challenge for EkoParty 2019. This was a fun challenge and thanks to Lukas and Nico from Blue Frost Security for making it happen(and for supporting our community)." /><meta property="og:description" content="This is a quick write up about how one of our team members, Thanasis, solved the challenge for EkoParty 2019. This was a fun challenge and thanks to Lukas and Nico from Blue Frost Security for making it happen(and for supporting our community)." /><link rel="canonical" href="https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/" /><meta property="og:url" content="https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/" /><meta property="og:site_name" content="trickster0’s Nest" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-05T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Solving the BFS Ekoparty 2019 Exploitation Challenge" /><meta name="twitter:site" content="@trickster012" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-05T17:46:16+08:00","datePublished":"2021-11-05T00:00:00+08:00","description":"This is a quick write up about how one of our team members, Thanasis, solved the challenge for EkoParty 2019. This was a fun challenge and thanks to Lukas and Nico from Blue Frost Security for making it happen(and for supporting our community).","headline":"Solving the BFS Ekoparty 2019 Exploitation Challenge","mainEntityOfPage":{"@type":"WebPage","@id":"https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/"},"url":"https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/"}</script><title>Solving the BFS Ekoparty 2019 Exploitation Challenge | trickster0's Nest</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="trickster0's Nest"><meta name="application-name" content="trickster0's Nest"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://www.clipartmax.com/png/middle/171-1712035_loki-chibi.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">trickster0's Nest</a></div><div class="site-subtitle font-italic">Pentester / Red Teamer / Malware Dev / Exploit Dev / Security Researcher</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/trickster0" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/trickster012" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Solving the BFS Ekoparty 2019 Exploitation Challenge</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Solving the BFS Ekoparty 2019 Exploitation Challenge</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> trickster0 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Nov 5, 2021, 12:00 AM +0800" >Nov 5, 2021<i class="unloaded">2021-11-05T00:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Nov 5, 2021, 11:46 AM +0200" >Nov 5, 2021<i class="unloaded">2021-11-05T17:46:16+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1498 words">8 min read</span></div></div><div class="post-content"><p>This is a quick write up about how one of our team members, Thanasis, solved the challenge for EkoParty 2019. This was a fun challenge and thanks to Lukas and Nico from Blue Frost Security for making it happen(and for supporting our community).</p><p>More information about the challenge can be found at:</p><p><a href="https://labs.bluefrostsecurity.de/blog/2019/09/07/bfs-ekoparty-2019-exploitation-challenge/">https://labs.bluefrostsecurity.de/blog/2019/09/07/bfs-ekoparty-2019-exploitation-challenge/</a></p><p>The application as the requirements provided, need to run in windows 10 x64 (RS6) version and the goal is to bypass ASLR and execute a calc.exe process.</p><p>By opening the application we can see via netstat that it binds on port 54321 on 0.0.0.0 (all the machine’s interfaces).</p><p>By opening Ghidra and going to the main function it is obvious that some checks need to bypassed in order to correctly send a payload to the application.<br /> In Ghidra, if we check the function that is called after the new connection is accepted, we see this:</p><p><a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/1.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/1.png" alt="" /></a></p><p>Upon first check, it checks for the first 0x10 bytes(16 chars) as a header.<br /> The second and third checks: If the header starts with 0x393130326f6b45(Ekoparty2019) then we are allowed to send a user_message as long as it is smaller than 0x201 bytes(513 chars).<br /> The last fourth check is quite important, we can send all this packet structure but it needs to be aligned correctly for 8 bytes. Meaning we could send 16,24,32 and so on.<br /> After we succeed in sending a big buffer, it appears that the application crashes after 529 bytes or so.<br /> By sending 528 bytes structured correctly with the cookie included in the beginning, we notice that before the calling function sub_140001170, we actually control the RAX, which is the 513 bytes.</p><p>Before this, there is this instruction</p><p><code class="language-plaintext highlighter-rouge">lea rcx, unk_7FF6A8A9E520</code></p><p>unk_7FF6A8A9E520, holds an array with this structure</p><p><a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/2.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/2.png" alt="" /></a></p><p>By sending the 513 characters, for example as A or \x41 we can make it so the function will return our byte + the rest of the pattern. In this case c3c3c3c3 + ourbyte+488b01.</p><p>The function sub_140001170 before it returns this value turns it to little endian, making it ourbyte+488b01c3c3c3c3. So we get 41488b01c3c3c3c3.</p><p>This value will be used in WriteProcessMemory as lpBuffer, basically copying these bytes to the function sub_7FF6A8A91000 as instructions allowing to control what we can execute when we reach it.</p><p>Although this is quite good, it provides a limitation of instructions, meaning we can only use instructions byte+488b01c3c3c3c3. I made a quick script in python producing all the values in a file</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>byte=0x00
endbyte=0xff  
start ="848b01c3c3c3"  
for i in xrange(byte,endbyte+1):  
            print format(i,'X')+ start
</pre></table></code></div></div><p>With a one-liner bash I got all the values:</p><p><code class="language-plaintext highlighter-rouge">for i in $(cat list_instructions);do echo -e "\n$i" &amp;&amp; rasm2 -b 64 -D $i ; done &gt; instructions</code></p><p>One good thing in this case is that we can actually control the RCX from our input buffer with the characters provided from 513 till 528.</p><p>The first thing I had to do was, get the process address from PEB.</p><p>By sending in our payload these are the last bytes:</p><p>“\x65\x65\x65\x65\x65\x65\x65\x65\x60\x00\x00\x00\x00\x00\x00\x00”</p><p>We could achieve and acquire the PEB. \x65 is meant for the combination from the previous instructions.</p><p>65488b01c3</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0:  65 48 8b 01             mov    rax,QWORD PTR gs:[rcx]  
4:  c3                      ret
</pre></table></code></div></div><p>It is well known that in x64 bit windows, GS register is a special register which points to PEB by providing the accurate offset. In this case since we could control RCX, we pointer GS directly to the PEB which is at offset 0x60 hence the highlighting.</p><p>Since the application will always sends us back the data leaked we can get this address and use it.</p><p>The next step would be to get the Image Base Address of the application.</p><p>Image Base Address is located from the PEB + 0x10 offset. In this case we had to set the address + 0x10 as a pointer to RCX to be able to leak the address.</p><p>In this case, according to our possible instructions we chose:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0:  47 8b 01                mov    rax,QWORD PTR [rcx]  
3:  c3                      ret
</pre></table></code></div></div><p>The first byte 47 and these as before are the last bytes of our payload:</p><p>“\x47\x65\x65\x65\x65\x65\x65\x65 + address+0x10”</p><p>As an end goal we need to create a ROP chain to execute calc.exe.</p><p>Since we would like to bypass ASLR, leakage is already useful but in case we would need to execute something, we would have to bypass DEP as well.</p><p>In this case it is good that we have, in the beginning of the application, a winexec call.</p><p><a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/3.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/3.png" alt="" /></a></p><p>Therefore, in the end we will call calc.exe through winexec but, winexec requires that the application will be executed to be pointed at, hence a pointer that points to the string calc.exe and a null terminator.</p><p>Somehow I had to be able to find that place in memory with my string. The best way was to get the StackBase Limit and get towards the stack base to find where it is.</p><p>First, I had to leak StackBase Limit.</p><p>StackBaseLimit is in the TEB at 0x10 offset through the GS register.</p><p>The initial request I used :</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0:  65 48 8b 01             mov    rax,QWORD PTR gs:[rcx]  
4:  c3                      ret
</pre></table></code></div></div><p>I controlled the RCX by setting it to 0x10.</p><p>After actually getting the leaked address of the Stack Base Limit, it is time for a loop towards the Stack Base to find the correct string which would be calc.exe.</p><p>By doing a loop, I started leaking the memory cells of the stack up to a point where it detected my string.</p><p>The moment the string was found, I saved into a counter and multiplied by 0x08 to get how many cells down the stack I had to go.</p><p>So now I had the address of the string.</p><p>In the above scenario I used:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0:  47 8b 01                mov    rax,QWORD PTR [rcx]  
3:  c3                      ret
</pre></table></code></div></div><p>With RCX as the Stack Base Limit and constantly adding 0x08 to it.</p><p>The next step would be to get the winexec’s address on the stack. By checking the .rdata of the application I could see the offset of it. <a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/4.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/4.png" alt="" /></a></p><p>In this case, I need to leak the address from Image Base Address + 0x9010 offset.</p><p>By using exactly the same instructions as before:</p><div class="language-plaintext highlighter-rouge"><div class="code-header" data-lang="plaintext"><button><i class="fa-fw far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0:  47 8b 01                mov    rax,QWORD PTR [rcx]  
3:  c3                      ret
</pre></table></code></div></div><p>Then adding RCX as the Image Base Address+0x9010 , I get the leaked address for Winexec on the stack.</p><p>For the final request to the application I used</p><p><code class="language-plaintext highlighter-rouge">0: 51 push rcx 1: 48 8b 01 mov rax,QWORD PTR [rcx] 4: c3 ret </code></p><p>I set the RCX to a pivot gadget “add rsp,78h ; ret”, so I can stack pivot.</p><p>I used Ropper and rp++ to get gadgets out of the application.</p><p>Thankfully, the ret instruction gets us to a point in our buffer.</p><p>According to MSDN Wincalc requires 2 arguments, the name of the application and a number which will set the mode of the window.</p><p>In windows 10 x64 , the calling convention is rcx,rdx,r8,r9 and top of the stack.</p><p>The structure of the packet is this. The whole packet is the cookie + 528 characters.</p><p>Structure:</p><div class="table-wrapper"><table><tbody><tr><td>16 junk bytes<td>padding<tr><td>pop_rax_gadget<td>Pop Image Base Address for having a valid address on RAX because the only pop rdx and pop rdx gadgets set bad values to it.<tr><td>Image Base Address – 0x08<td>valid address<tr><td>pop_rdx_gadget<td>pop rdx gadget to put 0x01 for the Wincalc second argument.<tr><td>0x01<td>Winexec UINT uCmdShow<tr><td>pop_rax_gadget<td>again for the same reason that the pop rcx gadget will set bad value to rax<tr><td>pop_rcx_gadget<td>set the pointer address that points to calc.exe\x00<tr><td>address_pointing_calc<td>address that points to calc.exe\x00<tr><td>72 junk bytes<td>padding<tr><td>ret_gadget<td>just a return gadget to fix the stack alignment to 16-byte format, because CreateProcessA is called inside the Winexec function which includes movabs instruction. Movabs instructions check if the stack is aligned and if not it will raise an exception.<tr><td>winexec_leaked_address<td>winexec address on the stack.<tr><td>add_rsp_0x78<td>adds to current RSP + 0x78 bytes to reach the next stack pivot.<tr><td>120 junk bytes<td>padding.<tr><td>add_rsp_0x78<td>adds to current RSP + 0x78 bytes to reach the next stack pivot.<tr><td>120 junk bytes<td>padding.<tr><td>add_rsp_0x28<td>adds to current RSP + 0x28 bytes to reach the next stack pivot.<tr><td>40 junk bytes<td>padding.<tr><td>add_rsp_0x58<td>adds to current RSP + 0x58 bytes to reach the original return pointer address and continue the execution of the application instead of crashing it.<tr><td>8 junk bytes<td>padding.<tr><td>calc.exe\x00<td>string to set in memory.<tr><td>15 junk bytes<td>padding.</table></div><p>Gadgets Used:</p><div class="table-wrapper"><table><thead><tr><th>Gadget Address<th>Gadget<tbody><tr><td>0x14000158b<td>add rsp, 0x78 ; ret ;<tr><td>x0000000140004525<td>pop rdx; add byte ptr [rax], al; cmp word ptr [rax], cx; je 0x4530; xor eax, eax; ret;<tr><td>0x140001167<td>pop rax ; ret ;<tr><td>0x00000001400089ab<td>pop rcx; or byte ptr [rax], al; add byte ptr [rax - 0x77], cl; add eax, 0x4b12; add rsp, 0x48; ret;<tr><td>0x0000000140001164<td>add rsp, 0x58; ret;<tr><td>0x14000158f<td>ret ;<tr><td>0x00000001400011d5<td>add rsp, 0x28; ret;</table></div><p>Full Working exploit: <a href="https://github.com/trickster0/BFS-Ekoparty-2019-challenge">https://github.com/trickster0/BFS-Ekoparty-2019-challenge</a></p><p>Proof of Concept:</p><p><a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/5.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/5.png" alt="" /></a></p><p>Results:</p><p><a href="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/unknown.png"><img data-proofer-ignore data-src="https://github.com/trickster0/trickster0.github.io/raw/master/assets/img/favicons/unknown.png" alt="" /></a></p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Solving the BFS Ekoparty 2019 Exploitation Challenge - trickster0's Nest&url=https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Solving the BFS Ekoparty 2019 Exploitation Challenge - trickster0's Nest&u=https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Solving the BFS Ekoparty 2019 Exploitation Challenge - trickster0's Nest&url=https://trickster0.github.io/posts/Solving-the-BFS-EkoParty/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Primitive-Injection/">Primitive Injection - Breaking the Status Quo</a><li><a href="/posts/Custom-ReadMemory-API/">Custom ReadMemory API</a><li><a href="/posts/Halo's-Gate-Evolves-to-Tartarus-Gate/">Halo's Gate Evolves -> Tartarus' Gate</a><li><a href="/posts/Solving-the-BFS-EkoParty/">Solving the BFS Ekoparty 2019 Exploitation Challenge</a><li><a href="/posts/earlybird-apc-queue-injection-with-processstatechange-a-twist/">EarlyBird APC Queue Injection With a ProcessStateChange Twist</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/vm/">vm</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/hack/">hack</a> <a class="post-tag" href="/tags/0/">%0</a> <a class="post-tag" href="/tags/asa/">asa</a> <a class="post-tag" href="/tags/certificate/">certificate</a> <a class="post-tag" href="/tags/cisco/">cisco</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Primitive-Injection/"><div class="card-body"> <span class="timeago small" >Jun 6<i class="unloaded">2025-06-06T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Primitive Injection - Breaking the Status Quo</h3><div class="text-muted small"><p> It has been a while, this is my research on trying to change the IOCs of a common remote process injection flow and the end result. I presented this in RedTreat in 2024 and I thought it was about t...</p></div></div></a></div><div class="card"> <a href="/posts/Custom-ReadMemory-API/"><div class="card-body"> <span class="timeago small" >Feb 13, 2022<i class="unloaded">2022-02-13T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Custom ReadMemory API</h3><div class="text-muted small"><p> After the great job and inspiration by x86matthew and his blogpost I decided to play with it as well for x64 bit. The NTAPI function in this method is RtlFirstEntrySList from ntdll.dll. Its definit...</p></div></div></a></div><div class="card"> <a href="/posts/Halo's-Gate-Evolves-to-Tartarus-Gate/"><div class="card-body"> <span class="timeago small" >Nov 27, 2021<i class="unloaded">2021-11-27T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Halo's Gate Evolves -> Tartarus' Gate</h3><div class="text-muted small"><p> A while ago in my twitter, I have mentioned what a huge fan I am of Hell’s Gate and Halo’s Gate. Hell’s Gate originally is a very creative way to fetch the syscall numbers by parsing the InMemoryOr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/earlybird-apc-queue-injection-with-processstatechange-a-twist/" class="btn btn-outline-primary" prompt="Older"><p>EarlyBird APC Queue Injection With a ProcessStateChange Twist</p></a> <a href="/posts/Halo's-Gate-Evolves-to-Tartarus-Gate/" class="btn btn-outline-primary" prompt="Newer"><p>Halo's Gate Evolves -> Tartarus' Gate</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">trickster0</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/vm/">vm</a> <a class="post-tag" href="/tags/challenge/">challenge</a> <a class="post-tag" href="/tags/challenges/">challenges</a> <a class="post-tag" href="/tags/hack/">hack</a> <a class="post-tag" href="/tags/0/">%0</a> <a class="post-tag" href="/tags/asa/">asa</a> <a class="post-tag" href="/tags/certificate/">certificate</a> <a class="post-tag" href="/tags/cisco/">cisco</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://trickster0.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
